} else if (data_log_trans) {
dfs$dfs <- dataLogTransform(dfs$dfs, base = data_log_base)
} else if (data_sqrt_trans) {
dfs$dfs <- dataSqrtTransform(dfs$dfs)
}
if (data_scale_trans) dfs$dfs <- dataScale(dfs$dfs)
data_X <- dfs$dfs[[1]]
data_Y <- dfs$dfs[[2]]
rCCA_regularization
rCCA_regularization = FALSE
cca <- statCCA(data_X, data_Y, rCCA_regularization, rCCA_n_points)
canonical_variate
canonical_variate = 1:2
cv_col = "gold"
id <- 1:nrow(X)
id <- 1:nrow(data_X)
g <- sample(0:1, nrow(data_X), replace = TRUE)
max_cvs <- min(ncol(cca$cca_data$X), ncol(cca$cca_data$Y))
if (length(canonical_variate) > 2) stop("plots_canonical_variate should have exactly two entries.")
if (any(canonical_variate < 0) | any(canonical_variate > (max_cvs - 1))) stop("Entries of plots_canonical_variate should be at least equal to 1 and most equal to ", max_cvs - 1, ".")
groups <- as.character(unique(g))
comparison <- setdiff(groups, names(g_col))
g_col = c("0" = "red", "1" = "blue")
comparison <- setdiff(groups, names(g_col))
if (length(comparison)) stop("The folowing groups do not have corresponding color in 'plotScore_group_color': ", paste(comparison, collapse = ", "))
cca_x <- cca$scores$U[, canonical_variate]
df_cca_x <- data.frame(cca_x, id = id, group = g, check.names = FALSE)
colnames(df_cca_x)[1:2] <- paste0("CV", 1:2)
df_cca_x$group <- as.character(df_cca_x$group)
df_cca_x$id <- as.character(df_cca_x$id)
p <- ggplot(data = df_cca_x, aes(x = CV1, y = CV2, colour = group)) +
geom_point(alpha = 1, size = 2) +
geom_hline(yintercept = 0, alpha = 0.6, color = cv_col, size = 1.5) +
geom_vline(xintercept = 0, alpha = 0.6, color = cv_col, size = 1.5) +
scale_colour_manual("Group: ", values = g_col) +
theme_classic() +
theme(
legend.position = "top",
legend.box.background = element_rect(colour = "black"),
legend.text = element_text(size = 11),
axis.line = element_blank(),
axis.title = element_text(size = 15),
strip.text = element_text(size = 13)) +
labs(y = paste("Canonical variate", canonical_variate[2]),
x = paste("Canonical variate", canonical_variate[1]))
p
ggplot(data = df_cca_x, aes(x = CV1, y = CV2, colour = group)) +
geom_point(alpha = 1, size = 2, shape = 3) +
geom_hline(yintercept = 0, alpha = 0.6, color = cv_col, size = 1.5) +
geom_vline(xintercept = 0, alpha = 0.6, color = cv_col, size = 1.5) +
scale_colour_manual("Group: ", values = g_col) +
theme_classic() +
theme(
legend.position = "top",
legend.box.background = element_rect(colour = "black"),
legend.text = element_text(size = 11),
axis.line = element_blank(),
axis.title = element_text(size = 15),
strip.text = element_text(size = 13)) +
labs(y = paste("Canonical variate", canonical_variate[2]),
x = paste("Canonical variate", canonical_variate[1]))
ggplot(data = df_cca_x, aes(x = CV1, y = CV2, colour = group)) +
geom_point(alpha = 1, size = 2, shape = 4) +
geom_hline(yintercept = 0, alpha = 0.6, color = cv_col, size = 1.5) +
geom_vline(xintercept = 0, alpha = 0.6, color = cv_col, size = 1.5) +
scale_colour_manual("Group: ", values = g_col) +
theme_classic() +
theme(
legend.position = "top",
legend.box.background = element_rect(colour = "black"),
legend.text = element_text(size = 11),
axis.line = element_blank(),
axis.title = element_text(size = 15),
strip.text = element_text(size = 13)) +
labs(y = paste("Canonical variate", canonical_variate[2]),
x = paste("Canonical variate", canonical_variate[1]))
ggplot(data = df_cca_x, aes(x = CV1, y = CV2, colour = group)) +
geom_point(alpha = 1, size = 2, shape = 5) +
geom_hline(yintercept = 0, alpha = 0.6, color = cv_col, size = 1.5) +
geom_vline(xintercept = 0, alpha = 0.6, color = cv_col, size = 1.5) +
scale_colour_manual("Group: ", values = g_col) +
theme_classic() +
theme(
legend.position = "top",
legend.box.background = element_rect(colour = "black"),
legend.text = element_text(size = 11),
axis.line = element_blank(),
axis.title = element_text(size = 15),
strip.text = element_text(size = 13)) +
labs(y = paste("Canonical variate", canonical_variate[2]),
x = paste("Canonical variate", canonical_variate[1]))
ggplot(data = df_cca_x, aes(x = CV1, y = CV2, colour = group)) +
geom_point(alpha = 0.5, size = 2, shape = 6) +
geom_hline(yintercept = 0, alpha = 0.6, color = cv_col, size = 1.5) +
geom_vline(xintercept = 0, alpha = 0.6, color = cv_col, size = 1.5) +
scale_colour_manual("Group: ", values = g_col) +
theme_classic() +
theme(
legend.position = "top",
legend.box.background = element_rect(colour = "black"),
legend.text = element_text(size = 11),
axis.line = element_blank(),
axis.title = element_text(size = 15),
strip.text = element_text(size = 13)) +
labs(y = paste("Canonical variate", canonical_variate[2]),
x = paste("Canonical variate", canonical_variate[1]))
ggplot(data = df_cca_x, aes(x = CV1, y = CV2, colour = group)) +
geom_point(alpha = 0.5, size = 2, shape = 21) +
geom_hline(yintercept = 0, alpha = 0.6, color = cv_col, size = 1.5) +
geom_vline(xintercept = 0, alpha = 0.6, color = cv_col, size = 1.5) +
scale_colour_manual("Group: ", values = g_col) +
theme_classic() +
theme(
legend.position = "top",
legend.box.background = element_rect(colour = "black"),
legend.text = element_text(size = 11),
axis.line = element_blank(),
axis.title = element_text(size = 15),
strip.text = element_text(size = 13)) +
labs(y = paste("Canonical variate", canonical_variate[2]),
x = paste("Canonical variate", canonical_variate[1]))
ggplot(data = df_cca_x, aes(x = CV1, y = CV2, colour = group)) +
geom_point(alpha = 0.5, size = 2, shape = 3) +
geom_hline(yintercept = 0, alpha = 0.6, color = cv_col, size = 1.5) +
geom_vline(xintercept = 0, alpha = 0.6, color = cv_col, size = 1.5) +
scale_colour_manual("Group: ", values = g_col) +
theme_classic() +
theme(
legend.position = "top",
legend.box.background = element_rect(colour = "black"),
legend.text = element_text(size = 11),
axis.line = element_blank(),
axis.title = element_text(size = 15),
strip.text = element_text(size = 13)) +
labs(y = paste("Canonical variate", canonical_variate[2]),
x = paste("Canonical variate", canonical_variate[1]))
ggplot(data = df_cca_x, aes(x = CV1, y = CV2, colour = group)) +
geom_point(alpha = 0.6, size = 2, shape = 3) +
geom_hline(yintercept = 0, alpha = 0.6, color = cv_col, size = 1.5) +
geom_vline(xintercept = 0, alpha = 0.6, color = cv_col, size = 1.5) +
scale_colour_manual("Group: ", values = g_col) +
theme_classic() +
theme(
legend.position = "top",
legend.box.background = element_rect(colour = "black"),
legend.text = element_text(size = 11),
axis.line = element_blank(),
axis.title = element_text(size = 15),
strip.text = element_text(size = 13)) +
labs(y = paste("Canonical variate", canonical_variate[2]),
x = paste("Canonical variate", canonical_variate[1]))
ggplot(data = df_cca_x, aes(x = CV1, y = CV2, colour = group)) +
geom_point(alpha = 0.6, size = 2, shape = 3) +
geom_hline(yintercept = 0, alpha = 0.6, color = cv_col, size = 1.5) +
geom_vline(xintercept = 0, alpha = 0.6, color = cv_col, size = 1.5) +
scale_colour_manual("Group: ", values = g_col) +
theme_classic() +
theme(
legend.position = "top",
legend.box.background = element_rect(colour = "black"),
panel.grid.major = element_line(),
legend.text = element_text(size = 11),
axis.line = element_blank(),
axis.title = element_text(size = 15),
strip.text = element_text(size = 13)) +
labs(y = paste("Canonical variate", canonical_variate[2]),
x = paste("Canonical variate", canonical_variate[1]))
ggplot(data = df_cca_x, aes(x = CV1, y = CV2, colour = group)) +
geom_point(alpha = 0.6, size = 2, shape = 3) +
geom_hline(yintercept = 0, alpha = 0.6, color = cv_col, size = 1.5) +
geom_vline(xintercept = 0, alpha = 0.6, color = cv_col, size = 1.5) +
scale_colour_manual("Group: ", values = g_col) +
theme_classic() +
theme(
legend.position = "top",
legend.box.background = element_rect(colour = "black"),
panel.grid.major = element_line(),
panel.grid.minor = element_line(),
legend.text = element_text(size = 11),
axis.line = element_blank(),
axis.title = element_text(size = 15),
strip.text = element_text(size = 13)) +
labs(y = paste("Canonical variate", canonical_variate[2]),
x = paste("Canonical variate", canonical_variate[1]))
ggplot(data = df_cca_x, aes(x = CV1, y = CV2, colour = group)) +
geom_point(alpha = 0.6, size = 2, shape = 3) +
geom_hline(yintercept = 0, alpha = 0.6, color = cv_col, size = 1.5) +
geom_vline(xintercept = 0, alpha = 0.6, color = cv_col, size = 1.5) +
scale_colour_manual("Group: ", values = g_col) +
scale_y_continuous(breaks = seq(-100, 100, 1)) +
theme_classic() +
theme(
legend.position = "top",
legend.box.background = element_rect(colour = "black"),
panel.grid.major = element_line(),
panel.grid.minor = element_line(),
legend.text = element_text(size = 11),
axis.line = element_blank(),
axis.title = element_text(size = 15),
strip.text = element_text(size = 13)) +
labs(y = paste("Canonical variate", canonical_variate[2]),
x = paste("Canonical variate", canonical_variate[1]))
ggplot(data = df_cca_x, aes(x = CV1, y = CV2, colour = group)) +
geom_point(alpha = 0.6, size = 2, shape = 3) +
geom_hline(yintercept = 0, alpha = 0.6, color = cv_col, size = 1.5) +
geom_vline(xintercept = 0, alpha = 0.6, color = cv_col, size = 1.5) +
scale_colour_manual("Group: ", values = g_col) +
scale_y_continuous(breaks = seq(-100, 100, 1)) +
scale_x_continuous(breaks = seq(-100, 100, 1)) +
theme_classic() +
theme(
legend.position = "top",
legend.box.background = element_rect(colour = "black"),
panel.grid.major = element_line(),
legend.text = element_text(size = 11),
axis.line = element_blank(),
axis.title = element_text(size = 15),
strip.text = element_text(size = 13)) +
labs(y = paste("Canonical variate", canonical_variate[2]),
x = paste("Canonical variate", canonical_variate[1]))
cca_x <- cca$scores$V[, canonical_variate]
df_cca_x <- data.frame(cca_x, id = id, group = g, check.names = FALSE)
colnames(df_cca_x)[1:2] <- paste0("CV", 1:2)
df_cca_x$group <- as.character(df_cca_x$group)
df_cca_x$id <- as.character(df_cca_x$id)
ggplot(data = df_cca_x, aes(x = CV1, y = CV2, colour = group)) +
geom_point(alpha = 0.6, size = 2, shape = 3) +
geom_hline(yintercept = 0, alpha = 0.6, color = cv_col, size = 1.5) +
geom_vline(xintercept = 0, alpha = 0.6, color = cv_col, size = 1.5) +
scale_colour_manual("Group: ", values = g_col) +
scale_y_continuous(breaks = seq(-100, 100, 1)) +
scale_x_continuous(breaks = seq(-100, 100, 1)) +
theme_classic() +
theme(
legend.position = "top",
legend.box.background = element_rect(colour = "black"),
panel.grid.major = element_line(),
legend.text = element_text(size = 11),
axis.line = element_blank(),
axis.title = element_text(size = 15),
strip.text = element_text(size = 13)) +
labs(y = paste("Canonical variate", canonical_variate[2])
sasa
ggplot(data = df_cca_x, aes(x = CV1, y = CV2, colour = group)) +
geom_point(alpha = 0.6, size = 2, shape = 3) +
geom_hline(yintercept = 0, alpha = 0.6, color = cv_col, size = 1.5) +
geom_vline(xintercept = 0, alpha = 0.6, color = cv_col, size = 1.5) +
scale_colour_manual("Group: ", values = g_col) +
scale_y_continuous(breaks = seq(-100, 100, 1)) +
scale_x_continuous(breaks = seq(-100, 100, 1)) +
theme_classic() +
theme(
legend.position = "top",
legend.box.background = element_rect(colour = "black"),
panel.grid.major = element_line(),
legend.text = element_text(size = 11),
axis.line = element_blank(),
axis.title = element_text(size = 15),
strip.text = element_text(size = 13)) +
labs(y = paste("Canonical variate", canonical_variate[2]),
x = paste("Canonical variate", canonical_variate[1]))
x_title = "X"
y_title = "Y"
short_x_title = "x"
short_y_title = "y"
max_cvs <- min(ncol(cca$cca_data$X), ncol(cca$cca_data$Y))
if (length(canonical_variate) > 2) stop("plots_canonical_variate should have exactly two entries.")
if (any(canonical_variate < 0) | any(canonical_variate > (max_cvs - 1))) stop("Entries of plots_canonical_variate should be at least equal to 1 and most equal to ", max_cvs - 1, ".")
groups <- as.character(unique(g))
comparison <- setdiff(groups, names(g_col))
if (length(comparison)) stop("The folowing groups do not have corresponding color in 'plotScore_group_color': ", paste(comparison, collapse = ", "))
cca_x <- cca$scores$U[, canonical_variate]
cca_y <- cca$scores$V[, canonical_variate]
df_cca_x <- data.frame(cca_x, set = "X", id = id, group = g)
df_cca_y <- data.frame(cca_y, set = "Y", id = id, group = g)
colnames(df_cca_y)[1:2] <- colnames(df_cca_x)[1:2] <- paste0("CV", 1:2)
df_cca <- rbind(cca_x, cca_y)
df_cca$group <- as.character(df_cca$group)
df_cca$id <- as.character(df_cca$id)
df_cca <- as.data.frame(rbind(cca_x, cca_y))
df_cca$group <- as.character(df_cca$group)
rbind(cca_x, cca_y)
cca_x <- cca$scores$U[, canonical_variate]
cca_y <- cca$scores$V[, canonical_variate]
df_cca_x <- data.frame(cca_x, set = "X", id = id, group = g)
df_cca_y <- data.frame(cca_y, set = "Y", id = id, group = g)
colnames(df_cca_y)[1:2] <- colnames(df_cca_x)[1:2] <- paste0("CV", 1:2)
cca_x
df_cca_x
df_cca <- rbind(df_cca_x, df_cca_y))
df_cca <- rbind(df_cca_x, df_cca_y)
class(df_cca)
df_cca$group <- as.character(df_cca$group)
df_cca$id <- as.character(df_cca$id)
facet_label <- c(X = x_title, Y = y_title)
df_cca$label_x <- df_cca$label_y <- NA
df_cca$label_x[grep("X", df_cca$group)[1]] <- paste0(short_x_title, "-CV", canonical_variate[1])
df_cca$label_y[grep("X", df_cca$group)[1]] <- paste0(short_x_title, "-CV", canonical_variate[2])
df_cca$label_x[grep("Y", df_cca$group)[1]] <- paste0(short_y_title, "-CV", canonical_variate[1])
df_cca$label_y[grep("Y", df_cca$group)[1]] <- paste0(short_y_title, "-CV", canonical_variate[2])
head(df_cca)
df_cca$label_x <- df_cca$label_y <- NA
df_cca$label_x[grep("X", df_cca$set)[1]] <- paste0(short_x_title, "-CV", canonical_variate[1])
df_cca$label_y[grep("X", df_cca$set)[1]] <- paste0(short_x_title, "-CV", canonical_variate[2])
df_cca$label_x[grep("Y", df_cca$set)[1]] <- paste0(short_y_title, "-CV", canonical_variate[1])
df_cca$label_y[grep("Y", df_cca$set)[1]] <- paste0(short_y_title, "-CV", canonical_variate[2])
head(df_cca)
ggplot(data = df_cca_x, aes(x = CV1, y = CV2, group = set, colour = group)) +
geom_point(alpha = 0.6, size = 2, shape = 3) +
geom_hline(yintercept = 0, alpha = 0.6, color = cv_col, size = 1.5) +
geom_vline(xintercept = 0, alpha = 0.6, color = cv_col, size = 1.5) +
geom_text(aes(label = label_x), x = 0.2, y = 0.05, color = cv_col, size = 4.2, fontface = "bold") +
geom_text(aes(label = label_y), x = -0.05, y = -0.2, color = cv_col, angle = 90, size = 4.2, fontface = "bold") +
facet_wrap(~ set, labeller = as_labeller(facet_label)) +
scale_colour_manual("Group: ", values = g_col) +
scale_y_continuous(breaks = seq(-100, 100, 1)) +
scale_x_continuous(breaks = seq(-100, 100, 1)) +
theme_classic() +
theme(
legend.position = "top",
legend.box.background = element_rect(colour = "black"),
panel.grid.major = element_line(),
legend.text = element_text(size = 11),
axis.line = element_blank(),
axis.title = element_text(size = 15),
strip.text = element_text(size = 13)) +
labs(y = paste("Canonical variate", canonical_variate[2]),
x = paste("Canonical variate", canonical_variate[1]))
head(df_cca)
ggplot(data = df_cca, aes(x = CV1, y = CV2, group = set, colour = group)) +
geom_point(alpha = 0.6, size = 2, shape = 3) +
geom_hline(yintercept = 0, alpha = 0.6, color = cv_col, size = 1.5) +
geom_vline(xintercept = 0, alpha = 0.6, color = cv_col, size = 1.5) +
geom_text(aes(label = label_x), x = 0.2, y = 0.05, color = cv_col, size = 4.2, fontface = "bold") +
geom_text(aes(label = label_y), x = -0.05, y = -0.2, color = cv_col, angle = 90, size = 4.2, fontface = "bold") +
facet_wrap(~ set, labeller = as_labeller(facet_label)) +
scale_colour_manual("Group: ", values = g_col) +
scale_y_continuous(breaks = seq(-100, 100, 1)) +
scale_x_continuous(breaks = seq(-100, 100, 1)) +
theme_classic() +
theme(
legend.position = "top",
legend.box.background = element_rect(colour = "black"),
panel.grid.major = element_line(),
legend.text = element_text(size = 11),
axis.line = element_blank(),
axis.title = element_text(size = 15),
strip.text = element_text(size = 13)) +
labs(y = paste("Canonical variate", canonical_variate[2]),
x = paste("Canonical variate", canonical_variate[1]))
minX_x <- min(cca_x[, "CV1"])
minX_y <- min(cca_x[, "CV2"])
minY_x <- min(cca_y[, "CV1"])
minY_y <- min(cca_y[, "CV2"])
min_x <- max(minX_x, minY_x)
min_y <- max(minX_y, minY_y)
minX_x <- min(cca_x[, "CV1"])
minX_x <- min(cca_x[, 1])
minX_y <- min(cca_x[, 2])
minY_x <- min(cca_y[, 1])
minY_y <- min(cca_y[, 2])
min_x <- max(minX_x, minY_x)
min_y <- max(minX_y, minY_y)
ggplot(data = df_cca, aes(x = CV1, y = CV2, group = set, colour = group)) +
geom_point(alpha = 0.6, size = 2, shape = 3) +
geom_hline(yintercept = 0, alpha = 0.6, color = cv_col, size = 1.5) +
geom_vline(xintercept = 0, alpha = 0.6, color = cv_col, size = 1.5) +
geom_text(aes(label = label_x), x = min_x, y = min_y, color = cv_col, size = 4.2, fontface = "bold") +
geom_text(aes(label = label_y), x = min_x, y = min_y, color = cv_col, angle = 90, size = 4.2, fontface = "bold") +
facet_wrap(~ set, labeller = as_labeller(facet_label)) +
scale_colour_manual("Group: ", values = g_col) +
scale_y_continuous(breaks = seq(-100, 100, 1)) +
scale_x_continuous(breaks = seq(-100, 100, 1)) +
theme_classic() +
theme(
legend.position = "top",
legend.box.background = element_rect(colour = "black"),
panel.grid.major = element_line(),
legend.text = element_text(size = 11),
axis.line = element_blank(),
axis.title = element_text(size = 15),
strip.text = element_text(size = 13)) +
labs(y = paste("Canonical variate", canonical_variate[2]),
x = paste("Canonical variate", canonical_variate[1]))
ggplot(data = df_cca, aes(x = CV1, y = CV2, group = set, colour = group)) +
geom_point(alpha = 0.6, size = 2, shape = 3) +
geom_hline(yintercept = 0, alpha = 0.6, color = cv_col, size = 1.5) +
geom_vline(xintercept = 0, alpha = 0.6, color = cv_col, size = 1.5) +
geom_text(aes(label = label_x), x = 0.5, y = min_y, color = cv_col, size = 4.2, fontface = "bold") +
geom_text(aes(label = label_y), x = min_x, y = 0.5, color = cv_col, angle = 90, size = 4.2, fontface = "bold") +
facet_wrap(~ set, labeller = as_labeller(facet_label)) +
scale_colour_manual("Group: ", values = g_col) +
scale_y_continuous(breaks = seq(-100, 100, 1)) +
scale_x_continuous(breaks = seq(-100, 100, 1)) +
theme_classic() +
theme(
legend.position = "top",
legend.box.background = element_rect(colour = "black"),
panel.grid.major = element_line(),
legend.text = element_text(size = 11),
axis.line = element_blank(),
axis.title = element_text(size = 15),
strip.text = element_text(size = 13)) +
labs(y = paste("Canonical variate", canonical_variate[2]),
x = paste("Canonical variate", canonical_variate[1]))
ggplot(data = df_cca, aes(x = CV1, y = CV2, group = set, colour = group)) +
geom_point(alpha = 0.6, size = 2, shape = 3) +
geom_hline(yintercept = 0, alpha = 0.6, color = cv_col, size = 1.5) +
geom_vline(xintercept = 0, alpha = 0.6, color = cv_col, size = 1.5) +
geom_text(aes(label = label_x), x = min_x, y = 0.2, color = cv_col, size = 4.2, fontface = "bold") +
geom_text(aes(label = label_y), x = 0.2, y = min_y, color = cv_col, angle = 90, size = 4.2, fontface = "bold") +
facet_wrap(~ set, labeller = as_labeller(facet_label)) +
scale_colour_manual("Group: ", values = g_col) +
scale_y_continuous(breaks = seq(-100, 100, 1)) +
scale_x_continuous(breaks = seq(-100, 100, 1)) +
theme_classic() +
theme(
legend.position = "top",
legend.box.background = element_rect(colour = "black"),
panel.grid.major = element_line(),
legend.text = element_text(size = 11),
axis.line = element_blank(),
axis.title = element_text(size = 15),
strip.text = element_text(size = 13)) +
labs(y = paste("Canonical variate", canonical_variate[2]),
x = paste("Canonical variate", canonical_variate[1]))
ggplot(data = df_cca, aes(x = CV1, y = CV2, group = set, colour = group)) +
geom_point(alpha = 0.6, size = 2, shape = 3) +
geom_hline(yintercept = 0, alpha = 0.6, color = cv_col, size = 1.5) +
geom_vline(xintercept = 0, alpha = 0.6, color = cv_col, size = 1.5) +
geom_text(aes(label = label_x), x = min_x, y = 0.1, color = cv_col, size = 4.2, fontface = "bold") +
geom_text(aes(label = label_y), x = 0.1, y = min_y, color = cv_col, angle = 90, size = 4.2, fontface = "bold") +
facet_wrap(~ set, labeller = as_labeller(facet_label)) +
scale_colour_manual("Group: ", values = g_col) +
scale_y_continuous(breaks = seq(-100, 100, 1)) +
scale_x_continuous(breaks = seq(-100, 100, 1)) +
theme_classic() +
theme(
legend.position = "top",
legend.box.background = element_rect(colour = "black"),
panel.grid.major = element_line(),
legend.text = element_text(size = 11),
axis.line = element_blank(),
axis.title = element_text(size = 15),
strip.text = element_text(size = 13)) +
labs(y = paste("Canonical variate", canonical_variate[2]),
x = paste("Canonical variate", canonical_variate[1]))
ggplot(data = df_cca, aes(x = CV1, y = CV2, group = set, colour = group)) +
geom_point(alpha = 0.6, size = 2, shape = 3) +
geom_hline(yintercept = 0, alpha = 0.6, color = cv_col, size = 1.5) +
geom_vline(xintercept = 0, alpha = 0.6, color = cv_col, size = 1.5) +
geom_text(aes(label = label_x), x = min_x, y = 0.15, color = cv_col, size = 4.2, fontface = "bold") +
geom_text(aes(label = label_y), x = 0.1, y = min_y, color = cv_col, angle = 90, size = 4.2, fontface = "bold") +
facet_wrap(~ set, labeller = as_labeller(facet_label)) +
scale_colour_manual("Group: ", values = g_col) +
scale_y_continuous(breaks = seq(-100, 100, 1)) +
scale_x_continuous(breaks = seq(-100, 100, 1)) +
theme_classic() +
theme(
legend.position = "top",
legend.box.background = element_rect(colour = "black"),
panel.grid.major = element_line(),
legend.text = element_text(size = 11),
axis.line = element_blank(),
axis.title = element_text(size = 15),
strip.text = element_text(size = 13)) +
labs(y = paste("Canonical variate", canonical_variate[2]),
x = paste("Canonical variate", canonical_variate[1]))
ggplot(data = df_cca, aes(x = CV1, y = CV2, group = set, colour = group)) +
geom_point(alpha = 0.6, size = 2, shape = 3) +
geom_hline(yintercept = 0, alpha = 0.6, color = cv_col, size = 1.5) +
geom_vline(xintercept = 0, alpha = 0.6, color = cv_col, size = 1.5) +
geom_text(aes(label = label_x), x = min_x, y = 0.15, color = cv_col, size = 4.2, fontface = "bold") +
geom_text(aes(label = label_y), x = 0.1, y = min_y, color = cv_col, angle = 90, size = 4.2, fontface = "bold") +
facet_wrap(~ set, labeller = as_labeller(facet_label)) +
scale_colour_manual("Group: ", values = g_col) +
scale_y_continuous(breaks = seq(-100, 100, 1)) +
scale_x_continuous(breaks = seq(-100, 100, 1)) +
theme_classic() +
theme(
legend.position = "top",
legend.box.background = element_rect(colour = "black"),
panel.border = element_rect(colour = "black", fill = NA)
panel.grid.major = element_line(),
legend.text = element_text(size = 11),
axis.line = element_blank(),
axis.title = element_text(size = 15),
strip.text = element_text(size = 13)) +
labs(y = paste("Canonical variate", canonical_variate[2]),
x = paste("Canonical variate", canonical_variate[1]))
ggplot(data = df_cca, aes(x = CV1, y = CV2, group = set, colour = group)) +
geom_point(alpha = 0.6, size = 2, shape = 3) +
geom_hline(yintercept = 0, alpha = 0.6, color = cv_col, size = 1.5) +
geom_vline(xintercept = 0, alpha = 0.6, color = cv_col, size = 1.5) +
geom_text(aes(label = label_x), x = min_x, y = 0.15, color = cv_col, size = 4.2, fontface = "bold") +
geom_text(aes(label = label_y), x = 0.1, y = min_y, color = cv_col, angle = 90, size = 4.2, fontface = "bold") +
facet_wrap(~ set, labeller = as_labeller(facet_label)) +
scale_colour_manual("Group: ", values = g_col) +
scale_y_continuous(breaks = seq(-100, 100, 1)) +
scale_x_continuous(breaks = seq(-100, 100, 1)) +
theme_classic() +
theme(
legend.position = "top",
legend.box.background = element_rect(colour = "black"),
panel.border = element_rect(colour = "black", fill = NA),
panel.grid.major = element_line(),
legend.text = element_text(size = 11),
axis.line = element_blank(),
axis.title = element_text(size = 15),
strip.text = element_text(size = 13)) +
labs(y = paste("Canonical variate", canonical_variate[2]),
x = paste("Canonical variate", canonical_variate[1]))
